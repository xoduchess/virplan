<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Virtual Planner</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="cal.css">
    </head>
    <body>
        <!--<div id='parent'>-->
    <!--Add Task area-->
    <textarea id="taskbox" draggable ="true" ondragstart="drag(event)" > What's your Task? </textarea>

    <!--* added from Pinch&ColorSwitch branch (index.html)-->
    <script src="https://cdn.rawgit.com/hammerjs/touchemulator/master/touch-emulator.js"></script>
    <script> TouchEmulator(); </script>
    <script src="https://hammerjs.github.io/dist/hammer.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="https://cdn.rawgit.com/julianshapiro/velocity/master/velocity.min.js"></script>
    <!-- end -->

    <!-- code for functionality -->
    <script>

       //* create variable that gets an element by id 
       taskbox = document.getElementById("taskbox");
       //looks for the element with this id 
       $taskbox = jQuery(taskbox); //* *added from Pinch&ColorSwitch branch (index.js) 

      ///* added from Pinch&ColorSwitch branch (index.js)
       // create a manager for that element
       var manager = new Hammer.Manager(taskbox);

       // create recognizer
       var Pan = new Hammer.Pan(); 

       // add the recognizer 
       manager.add(Pan);

      // axis
       var deltaX = 0;
       var deltaY = 0;

       //** when starting to pan
       manager.on('panstart',function(e){
        //** add 'dragging-task' to the triggered element's class list
          e.target.classList.add('dragging-task');
            
       })

       //when panning (moving) element
       manager.on('panmove', function(e) {
        
        var dX = deltaX + (e.deltaX);
        var dY = deltaY + (e.deltaY);
        $.Velocity.hook($taskbox, 'translateX', dX + 'px');
        
        //** selects element immediately below the cursor by raising textbox 30 px above it
        $.Velocity.hook($taskbox, 'translateY', dY - 30 + 'px');
      
       });

       //when panning ends
       manager.on('panend', function(e) {
       deltaX = deltaX + e.deltaX;
       deltaY = deltaY + e.deltaY;
     //end of add from branch */


       //** variable to get element right behind cursor //
       selected = document.elementFromPoint(e.center.x, e.center.y); //should be one of the day blocks in the calendar
       
       //** add copy of the element to the calendar
       var copied = e.target.cloneNode(); //puts copy of the element into variable
       copied.classList.add('acquired-task'); //adds class to classList so copy has same width 

       //** CSS transform property 
       copied.style.transform = "none"; 
       e.target.style.transform = "none";

       //place element on the calendar
       selected.appendChild(copied);
       //resets axis' coordinates 
       deltaX = 0; //start from zero again
       deltaY = 0;

      });

        //Allow elements to be dropped
        function allowDrop(task){ 
            task.preventDefault();

            //** allows element to be copied before dragged
            task.effectAllowed =  "copyMove"; 
          }

        //What data should be dragged (Start dragging at taskbox)
        function drag(task){

            //** added class for dragging  
            task.target.classList.add('dragging-task');
              //task.dataTransfer.setData("text", task.target.id);
              //dataTransfer sets data type and value of task being dragged

            //** copied object will be dragged instead of dragging the original 
            task.dataTransfer.dropEffect = "copy"; 
          }

        //Repeat for Drop- Data can't be dropped in other elements(By Default)
        function drop(task){
            task.preventDefault(); 
            var taskdata = task.dataTransfer.getData("text"); 

              //*added cloneNode to clone the box instead so the box could be copied 
              //*created a new variable where the cloned node is placed
              //var newTask = document.getElementById(taskdata).cloneNode();


            //** get the first element in the class list and clone it 
            var newTask = document.getElementsByClassName('dragging-task')[0].cloneNode(); //clones the element being dragged
            //** remove dragging from class list since it's no longer needed 
            newTask.classList.remove("dragging-task");

            //** created new class so we can manipulate the copied object
            newTask.classList.add("acquired-task");
            newTask.removeAttribute("id");

            //** moves task into the calendar
            task.target.appendChild(newTask);
            
            //** drops the copied element and keeps original in place
            task.dataTransfer.dropEffect = "copy"; 

          }
    

    </script>

    <!--<script type="text/javascript">
        document.addEventListener("click", createTask); 
            
         function createTask(){ 
             //create container
             var c = document.getElementById("parent");
             var taskbox = document.createElement("textarea"); 
             
             //taskbox.id = "MyTaskBox"; 
             c.appendChild(taskbox);
}
       
       // var taskbox = document.createElement('textarea');
        //document.addEventListener("click", createTask); 
            
    
        
       /* function CreateTask(){ 
            var taskbox = document.createElement('textarea'); 
            document.getElementById('textarea').addEventListener('click');
            taskbox.appendChild(taskbox);}*/
        
     </script>


</div>
        <button> Create Task </button>
        <!--<button onClick="CreateTask()">Create Task</button> --><br><br>
 <div id= "monthcdiv" ondrop="drop(event)" ondragover="allowDrop(event)">
        <!--Canvas Creation-->
        <div class="CalendarMonth"> 
  <ul>
    
    
    <li>
      ~ November 
      <span style="font-size:30px"> 2016 ~</span>
    </li>
  </ul>
</div>

<ul class="Weekdays">
  <li>Sunday</li>
  <li>Monday</li>
  <li>Tuesday</li>
  <li>Wednesday</li>
  <li>Thursday</li>
  <li>Friday</li>
  <li>Saturday</li>
  
</ul>

<ul class="Days"> 
    <li>30<br><br><br><br><br><br><br><br><br><br></li>
    <li>31<br><br><br><br><br><br><br><br><br><br></li>
  <li>1<br><br><br><br><br><br><br><br><br><br></li>
  <li>2<br><br><br><br><br><br><br><br><br><br></li>
  <li>3<br><br><br><br><br><br><br><br><br><br></li>
  <li>4<br><br><br><br><br><br><br><br><br><br></li>
  <li>5<br><br><br><br><br><br><br><br><br><br></li>
  <li>6<br><br><br><br><br><br><br><br><br><br></li>
  <li>7<br><br><br><br><br><br><br><br><br><br></li>
  <li>8<br><br><br><br><br><br><br><br><br><br></li>
  <li>9<br><br><br><br><br><br><br><br><br><br></li>
  <li>10<br><br><br><br><br><br><br><br><br><br></li>
  <li>11<br><br><br><br><br><br><br><br><br><br></li>
  <li>12<br><br><br><br><br><br><br><br><br><br></li>
  <li>13<br><br><br><br><br><br><br><br><br><br></li>
  <li>14<br><br><br><br><br><br><br><br><br><br></li>
  <li>15<br><br><br><br><br><br><br><br><br><br></li>
  <li>16<br><br><br><br><br><br><br><br><br><br></li>
  <li><br><br><br><br><br><br><br><br><br><span class="active">17</span></li>
  <li>18<br><br><br><br><br><br><br><br><br><br></li>
  <li>19<br><br><br><br><br><br><br><br><br><br></li>
  <li>20<br><br><br><br><br><br><br><br><br><br></li>
  <li>21<br><br><br><br><br><br><br><br><br><br></li>
  <li>22<br><br><br><br><br><br><br><br><br><br></li>
  <li>23<br><br><br><br><br><br><br><br><br><br></li>
  <li>24<br><br><br><br><br><br><br><br><br><br></li>
  <li>25<br><br><br><br><br><br><br><br><br><br></li>
  <li>26<br><br><br><br><br><br><br><br><br><br></li>
  <li>27<br><br><br><br><br><br><br><br><br><br></li>
  <li>28<br><br><br><br><br><br><br><br><br><br></li>
  <li>29<br><br><br><br><br><br><br><br><br><br></li>
  <li>30<br><br><br><br><br><br><br><br><br><br></li>
</ul>
    </div>
        
      <!--<canvas id= "theCanvas" width="1000" height="1000"> </canvas> -->
      <!-- <script type="text/javascript" language="javascript">
      <!--<button> Create Task </button>
   
      <div id= "parent">  
    </div>-->
   
   
    <!--<script>
      var canvas = document.getElementById('myCanvas');
      var context = canvas.getContext('2d');

      context.beginPath();
      context.moveTo(100, 150);
      context.lineTo(450, 50);
      context.stroke();
    </script>

    //Writing to Canvas
      /*
      var canvas = document.getElementById("theCanvas"); 
      var ctx = canvas.getContext("2d"); 
          ctx.moveTo(0,0); 
          ctx.lineTo(100,100);  
          ctx.stroke();
            
    </script> 
      <script type="text/javascript">
  
      var cal = new Calendar();
      cal.generateHTML();
      document.write(cal.getHTML());*/

    </script>-->
 
    </body>
</html>
